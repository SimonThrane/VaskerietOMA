@using Newtonsoft.Json.Converters
@model VaskerietOMA.ViewModel.TimeTableViewModel

@{
    ViewBag.Title = "Book en tid";
}


<script src="/Scripts/AngularController/weekctrl.js"></script>

<div ng-app="myApp">
<div ng-controller="WeekController as ctrl" ng-init="init(@Newtonsoft.Json.JsonConvert.SerializeObject(Model))" ng-cloak>
<h3 class="pull-left">Uge nr: {{ctrl.Weeknumber}}</h3>
<h1>Kalender</h1>
    <div>
        <label>
            Vælg en uge:
            <input id="WeekInput" type="week" name="input" ng-model="ctrl.Today" ng-change="ctrl.weekchange()"
                   placeholder="YYYY-W##" ng-min="ctrl.MinDate" ng-max="ctrl.Maxdate" required />
        </label>
    </div>
<table id="weektabel" class="col-md-12 col-lg-12 weektimeTable">
<tr class="head_nav">
    <th>Time <span class="	glyphicon glyphicon-time"></span></th>
    <th colspan="2">Monday</th>
    <th colspan="2">Tuesday</th>
    <th colspan="2">Wednesday</th>
    <th colspan="2">Thursday</th>
    <th colspan="2">Friday</th>
    <th colspan="2">Saturday</th>
    <th colspan="2">Sunday</th>
</tr>
<tr>
    <th></th>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
    <td>Venstre</td>
    <td>Højre</td>
</tr>
<tr>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Monday.Left">
                <td class="time" colspan="2">
                    {{times.TimeString}}
                                
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Monday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>

            <tr ng-repeat="times in ctrl.TimeTable.Monday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Tuesday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />

                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>

            <tr ng-repeat="times in ctrl.TimeTable.Tuesday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Wednesday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Wednesday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Thursday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>

            <tr ng-repeat="times in ctrl.TimeTable.Thursday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Friday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>

            <tr ng-repeat="times in ctrl.TimeTable.Friday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Saturday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>

            <tr ng-repeat="times in ctrl.TimeTable.Saturday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Sunday.Left">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
    <td>
        <table>
            <tr ng-repeat="times in ctrl.TimeTable.Sunday.Right">
                <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                    {{times.TimeString}}
                    <br />
                    <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                </td>
            </tr>
        </table>
    </td>
</tr>

</table>


<div ng-cloak="" class="DayTabs">
<md-content>
<md-tabs md-dynamic-height="" md-border-bottom="" md-selected="ctrl.selectedTab">
<md-tab label="Monday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Monday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Monday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Monday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Monday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </md-content>
</md-tab>
<md-tab label="Tuesday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Tuesday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Tuesday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Tuesday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Tuesday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </md-content>
</md-tab>
<md-tab label="Wednesday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Wednesday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Wednesday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Wednesday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Wednesday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </md-content>
</md-tab>
<md-tab label="Thursday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Thursday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Thursday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Thursday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Thursday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </md-content>
</md-tab>
<md-tab label="Friday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Friday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Friday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Friday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br/>
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Friday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

    </md-content>
</md-tab>
<md-tab label="Saturday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Saturday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Saturday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Saturday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Saturday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                                        {{times.RoomNumber}}
                                                    </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

    </md-content>
</md-tab>
<md-tab label="Sunday">
    <md-content class="md-padding">
        <h1 class="md-display-2">Sunday</h1>
        <table class="daytable">
            <tr>
                <th colspan="2">
                    Sunday
                </th>
            </tr>

            <tr>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Sunday.Left">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr ng-repeat="times in ctrl.TimeTable.Sunday.Right">
                            <td ng-click="ctrl.bookTime(times)" class="washtime" ng-class="{booked: times.IsBooked}">
                                {{times.TimeString}}
                                <br />
                                {{times.Machine}}
                                <br />
                                <span ng-if="times.IsBooked">
                                    {{times.RoomNumber}}
                                </span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </md-content>
</md-tab>
</md-tabs>
</md-content>
</div>


<!-- Modal -->
<script type="text/ng-template" id="Bookng.html">
    <form name="myForm">

        <div class="modal-header">
            <h3 class="modal-title" id="modal-title">Book WashTime</h3>
        </div>
        <div class="modal-body" id="modal-body">
            <span class="bold-text">Tidspunkt: </span> {{ctrl.currentTime.Time | date:'medium'}} <br />
            <span class="bold-text"> Maskine:</span> {{ctrl.currentTime.Machine}}
                <div ng-if="ctrl.currentTime.IsBooked">
                    <span class="bold-text">Værelse:</span> {{ctrl.currentTime.RoomNumber}}
</div>
                <div ng-if="!ctrl.currentTime.IsBooked">
                    @*<span class="bold-text">Værelse:</span> <input name="roomInput" type="number" ng-model="ctrl.currentTime.RoomNumber" placeholder="Roomnumber" min="1" max="100" ng-pattern="integerval" roomValidator required />*@
                    <br />
                    <span ng-show="!ctrl.User.IsLoggedIn">
                        Log venligst ind for at booke en maskine
                    </span>
                </div>
                <div ng-if="ctrl.success">
                    <br />
                    Tillykke bookingen er gennemført.
                </div>
            <div ng-if="ctrl.Cancelsuccess">
                <br />
                Tillykke bookingen er afmeldt!
            </div>
</div>
        <div class="modal-footer">
            <button ng-if="ctrl.currentTime.IsBooked && (ctrl.currentTime.RoomNumber == ctrl.User.RoomNumber) " class="btn btn-primary" type="button" ng-click="ctrl.CancelBooking()">Cancel Bookig</button>
            <button ng-if="!ctrl.currentTime.IsBooked " class="btn btn-primary" type="button" ng-click="ctrl.ok()" ng-disabled="!ctrl.User.IsLoggedIn">Book tid</button>
            <button class="btn btn-warning" type="button" ng-click="ctrl.cancel()">Close</button>
        </div>
    </form>
    </script>

</div>
    
</div>

       

@section Scripts {
                @Scripts.Render("~/bundles/jqueryval")
            }
